```c++
#include<bits/stdc++.h>
using namespace std;
const int M=1e6+5,INF=1e9+5;
int Q,opt,x,child[M][2],val[M],dat[M],size[M],cnt[M],tot,root;
int neww(int p)
{
	val[++tot]=p,dat[tot]=rand(),size[tot]=cnt[tot]=1;
	return tot;
}
void pushup(int id)
{
	size[id]=size[child[id][0]]+size[child[id][1]]+cnt[id];
}
void buildtree()
{
	root=neww(-INF),child[root][1]=neww(INF);
	pushup(root);
}
void rotate(int &id,int d)
{
	int temp=child[id][d^1];
	child[id][d^1]=child[temp][d];
	child[temp][d]=id;
	id=temp;
	pushup(child[id][d]),pushup(id);
}
void insert(int &id,int v)
{
	if(!id)
	{
		id=neww(v);return;
	}
	if(v==val[id]) cnt[id]++;
	else
	{
		int d;
		if(v<val[id]) d=0;
		else d=1;
		insert(child[id][d],v);
		if(dat[id]<dat[child[id][d]]) rotate(id,d^1);
	}
	pushup(id);
}
void remove(int &id,int v)
{
	if(!id) return;
	if(v==val[id])
	{
		if(cnt[id]>1)
		{
			cnt[id]--,pushup(id);return;
		}
		if(child[id][0]||child[id][1])
		{
			if(!child[id][1]||dat[child[id][0]]>dat[child[id][1]])
				rotate(id,1),remove(child[id][1],v);
			else rotate(id,0),remove(child[id][0],v);
			pushup(id);
		}
		else id=0;
		return;
	}
	if(v<val[id]) remove(child[id][0],v);
	else remove(child[id][1],v);
	pushup(id);
}
int getrank(int id,int v)
{
	if(!id) return 1;
	if(v==val[id]) return size[child[id][0]]+1;
	else if(v<val[id]) return getrank(child[id][0],v);
	else return size[child[id][0]]+cnt[id]+getrank(child[id][1],v);
}
int getval(int id,int rank)
{
	if(!id) return INF;
	if(rank<=size[child[id][0]]) return getval(child[id][0],rank);
	else if(rank<=size[child[id][0]]+cnt[id]) return val[id];
	else return getval(child[id][1],rank-size[child[id][0]]-cnt[id]); 
}
int getpre(int v)
{
	int id=root,pre;
	while(id)
	{
		if(val[id]<v) pre=val[id],id=child[id][1];
		else id=child[id][0];
	}
	return pre;
}
int getnext(int v)
{
	int id=root,next;
	while(id)
	{
		if(val[id]>v) next=val[id],id=child[id][0];
		else id=child[id][1];
	}
	return next;
}
int main()
{
	buildtree();
	cin>>Q;
	for(int i=1;i<=Q;i++)
	{
		scanf("%d%d",&opt,&x);
		if(opt==1) insert(root,x);
		else if(opt==2) remove(root,x);
		else if(opt==3) printf("%d\n",getrank(root,x)-1);
		else if(opt==4) printf("%d\n",getval(root,x+1));
		else if(opt==5) printf("%d\n",getpre(x));
		else printf("%d\n",getnext(x));
	}
    /*
    1.向 M 中插入一个数 x。
	2.从 M 中删除一个数 x（若有多个相同的数，应只删除一个）。
	3.查询 M 中有多少个数比 x 小，并且将得到的答案加一。
	4.查询如果将 M 从小到大排列后，排名位于第 x 位的数。
	5.查询 M 中 x 的前驱（前驱定义为小于 x，且最大的数）。
	6.查询 M 中 x 的后继（后继定义为大于 x，且最小的数）。
    */
	return 0;
}
```

